import{e as a,h as n}from"/dist/chunk-n2t7x54v.js";function s(){return n("div",{class:"markdown-body",children:n(a,{children:[n("h1",{children:"rust 快速体验"},void 0,!1,void 0,this),`
`,n("p",{children:n("img",{src:"/images/3ed4a443f105e3102e28b44eb3855c87de738796.png",alt:"Rust 程序开发语言"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("h2",{children:"安装"},void 0,!1,void 0,this),`
`,n("p",{children:["使用 rustup 工具，crates 镜像设置为 ",n("code",{children:"rsproxy.io"},void 0,!1,void 0,this),"，工具链则选择 stable-x86_64-pc-windows-gnu。"]},void 0,!0,void 0,this),`
`,n("h3",{children:"问题"},void 0,!1,void 0,this),`
`,n("p",{children:["rust 有部分包使用了 ffi 得用现有的工具/库。比如 cargo-edit。使用这些包机器上需要安装 ",n("a",{href:"https://www.mingw-w64.org/",children:"mingw32-w64"},void 0,!1,void 0,this),"。"]},void 0,!0,void 0,this),`
`,n("p",{children:["mingw32-w64 官方分发的 gcc 还是 gcc8。可以从 ",n("a",{href:"https://winlibs.com/",children:"winlibs"},void 0,!1,void 0,this)," 下载较新的版本：gcc11。"]},void 0,!0,void 0,this),`
`,n("p",{children:[n("strong",{children:"windows 上还是推荐 msvc"},void 0,!1,void 0,this),"，毕竟官方支持是放在第一阶梯。"]},void 0,!0,void 0,this),`
`,n("h2",{children:"写点小工具"},void 0,!1,void 0,this),`
`,n("p",{children:["我用 rust 重做了之前写用 go 写的一个工具 ",n("a",{href:"https://github.com/yuekcc/picar",children:"picar"},void 0,!1,void 0,this),"。picar 是一个整理照片的工具，主要功能就是遍历目录中所有照片文件，读出其 exif 数据，按照 exif 记录的时间日期进行整理。比如一个照片（.jpg 文件）拍摄于 2021 年 12 月 30 日 12:30:45，移动到 ",n("pwd",{children:"/202121/prefix_20212130_123045.jpg。"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("p",{children:"功能非常简单，可以分为几个部分："},void 0,!1,void 0,this),`
`,n("ol",{children:[`
`,n("li",{children:n("strong",{children:"处理命令行"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("li",{children:[n("strong",{children:"遍历指定的目录"},void 0,!1,void 0,this),"，没有指定就使用当前目录"]},void 0,!0,void 0,this),`
`,n("li",{children:[n("strong",{children:"遍历目录所有文件"},void 0,!1,void 0,this),"，如果是照片文件，尝试",n("strong",{children:"获取 exif 数据"},void 0,!1,void 0,this),"，然后按上面的需求，",n("strong",{children:"移动（重新命名）文件"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`]},void 0,!0,void 0,this),`
`,n("p",{children:["为了提高效率。go 实现的版本使用了 ",n("code",{children:"gorutinue"},void 0,!1,void 0,this),"。记得在实现 go 语言版本时，对比过串行和 gorutinue 的效率。"]},void 0,!0,void 0,this),`
`,n("h2",{children:"代码量对比"},void 0,!1,void 0,this),`
`,n("p",{children:["picar-rs，代码可以在 ",n("a",{href:"https://github.com/yuekcc/picar-rs",children:"yuekcc/picar-rs"},void 0,!1,void 0,this)," 找到。目前已经实现基本功能。"]},void 0,!0,void 0,this),`
`,n("p",{children:"go 语言版本："},void 0,!1,void 0,this),`
`,n("pre",{className:"shiki github-dark",style:{backgroundColor:"#24292e",color:"#e1e4e8"},tabIndex:"0",children:n("code",{className:"language-sh",children:[n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:"$"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:" tokei.exe"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#9ECBFF"},children:"==============================================================================="},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Language"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"            Files"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"        Lines"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"         Code"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"     Comments"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"       Blanks"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#9ECBFF"},children:"==============================================================================="},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Go"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                      7"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          468"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          350"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           33"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           85"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Markdown"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                1"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           60"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           42"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           18"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Shell"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                   1"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            2"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            1"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            1"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#9ECBFF"},children:"==============================================================================="},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Total"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                   9"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          530"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          351"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           76"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          103"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#9ECBFF"},children:"==============================================================================="},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),`
`,n("p",{children:"rust 版本："},void 0,!1,void 0,this),`
`,n("pre",{className:"shiki github-dark",style:{backgroundColor:"#24292e",color:"#e1e4e8"},tabIndex:"0",children:n("code",{className:"language-sh",children:[n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:"$"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:" tokei.exe"},void 0,!1,void 0,this),n("span",{style:{color:"#6A737D"},children:" # 2022 年 04 月 25 日 更新"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#9ECBFF"},children:"==============================================================================="},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Language"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"            Files"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"        Lines"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"         Code"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"     Comments"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:"       Blanks"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#9ECBFF"},children:"==============================================================================="},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" TOML"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                    1"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           20"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           17"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            3"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#B392F0"},children:"-------------------------------------------------------------------------------"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Markdown"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                1"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           33"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           21"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           12"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:" |"},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"-"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:" Shell"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                1"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            4"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            4"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#E1E4E8"},children:" ("},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"Total"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:")                             "},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"37"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            4"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           21"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           12"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#B392F0"},children:"-------------------------------------------------------------------------------"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Rust"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                    4"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          279"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          218"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           61"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:" |"},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"-"},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:" Markdown"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"             2"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            7"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            7"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            0"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#E1E4E8"},children:" ("},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"Total"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:")                            "},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"286"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          218"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"            7"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           61"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#9ECBFF"},children:"==============================================================================="},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#B392F0"},children:" Total"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"                   6"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          332"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"          235"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           21"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"           76"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#9ECBFF"},children:"==============================================================================="},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),`
`,n("p",{children:"仓库中的主要就是逻辑处理的代码。比较意外的是 rust 的代码量比 go 版本要少。就是在工具这种领域，go 并不比 rust 有太多的优势，而且 rust 更容易集成旧的 c/c++ 代码。所以在工具开发领域，rust 反而更有优势，生态上几乎直接并入 c/c++。"},void 0,!1,void 0,this),`
`,n("h2",{children:"上手感受"},void 0,!1,void 0,this),`
`,n("p",{children:["就目前的这点代码来看，感受最强烈的就是 rust 一股 functional 味道。我的工作语言是 js，所以对于 ",n("code",{children:".forEach"},void 0,!1,void 0,this),"、",n("code",{children:".map"},void 0,!1,void 0,this)," 这类 api 会有一种相当熟悉的感觉。另一点则是视觉上的感受，全屏看下来，非常多的 ",n("code",{children:"< ... >"},void 0,!1,void 0,this),"。rust 有一些设计在初学时不容易想明白，比如 ",n("code",{children:"String"},void 0,!1,void 0,this)," 和 ",n("code",{children:"&str"},void 0,!1,void 0,this)," ，",n("code",{children:"Path"},void 0,!1,void 0,this)," 和",n("code",{children:"PathBuf"},void 0,!1,void 0,this)," 分不清。"]},void 0,!0,void 0,this),`
`,n("p",{children:"经过多年的发展，rust 的工具已经比较成熟，没有太多历史包袱。配合 rust-analyser、clippy 可以直接上手写代码了。我也是在了解一些基本语法后，就开始实现 picar-rs。先写一个能工作的 demo，再重写一个设计更合理的实现。"},void 0,!1,void 0,this),`
`,n("p",{children:"一些场景 rust 的代码其实更简洁。比如下面的代码。"},void 0,!1,void 0,this),`
`,n("pre",{className:"shiki github-dark",style:{backgroundColor:"#24292e",color:"#e1e4e8"},tabIndex:"0",children:n("code",{className:"language-rust",children:[n("span",{className:"line",children:n("span",{style:{color:"#6A737D"},children:"// rust"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#6A737D"},children:"// 获取目录下所有文件"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#6A737D"},children:"//"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"fn"},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:" read_dir"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"(dir"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:":"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:" &"},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"Path"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:") "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"->"},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:" Vec"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"<"},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"PathBuf"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"> {"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"    let"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" entries "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"="},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" dir"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"read_dir"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"()"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"expect"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"("},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:'"not a directory"'},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:");"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#E1E4E8"},children:"    entries"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"        ."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"flatten"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"()"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"        ."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"filter"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"("},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"|"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"it"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"|"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" it"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"path"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"()"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"is_file"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"())"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"        ."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"map"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"("},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"|"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"entry"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"|"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" entry"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"path"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"())"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"        ."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"collect"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"()"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#E1E4E8"},children:"}"},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),`
`,n("p",{children:"相应的功能，使用 go 实现："},void 0,!1,void 0,this),`
`,n("pre",{className:"shiki github-dark",style:{backgroundColor:"#24292e",color:"#e1e4e8"},tabIndex:"0",children:n("code",{className:"language-go",children:[n("span",{className:"line",children:n("span",{style:{color:"#6A737D"},children:"// go"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#6A737D"},children:"// 取得文件列表"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#6A737D"},children:"//"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"func"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" ("},void 0,!1,void 0,this),n("span",{style:{color:"#FFAB70"},children:"t "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"*"},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"Task"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:") "},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"getFileList"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"() ([]"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"string"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:", "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"error"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:") {"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#E1E4E8"},children:"    log."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"Println"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"("},void 0,!1,void 0,this),n("span",{style:{color:"#9ECBFF"},children:'"读取目录："'},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:", t.dir)"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line"},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#E1E4E8"},children:"    items, err "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:":="},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" os."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"ReadDir"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"(t.dir)"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"    if"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" err "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"!="},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:" nil"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" {"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"        return"},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:" nil"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:", err"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#E1E4E8"},children:"    }"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line"},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#E1E4E8"},children:"    itemsLen "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:":="},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:" len"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"(items)"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#E1E4E8"},children:"    result "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:":="},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:" make"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"([]"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"string"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:", itemsLen)"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"    for"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" i "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:":="},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:" 0"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"; i "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"<"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" itemsLen; i"},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"++"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" {"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#E1E4E8"},children:"        item "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:":="},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" items[i]"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line"},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#6A737D"},children:"        // 忽略子目录"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"        if"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" item."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"IsDir"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"() {"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#F97583"},children:"            continue"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#E1E4E8"},children:"        }"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line"},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#E1E4E8"},children:"        result[i] "},void 0,!1,void 0,this),n("span",{style:{color:"#F97583"},children:"="},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" filepath."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"Join"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"(t.dir, item."},void 0,!1,void 0,this),n("span",{style:{color:"#B392F0"},children:"Name"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:"())"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#E1E4E8"},children:"    }"},void 0,!1,void 0,this)},void 0,!1,void 0,this),`
`,n("span",{className:"line"},void 0,!1,void 0,this),`
`,n("span",{className:"line",children:[n("span",{style:{color:"#F97583"},children:"    return"},void 0,!1,void 0,this),n("span",{style:{color:"#E1E4E8"},children:" result, "},void 0,!1,void 0,this),n("span",{style:{color:"#79B8FF"},children:"nil"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),`
`,n("span",{className:"line",children:n("span",{style:{color:"#E1E4E8"},children:"}"},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),`
`,n("p",{children:"如果熟悉 java stream api 的朋友，看到 rust 的实现“就是函数式编程嘛”。go 的代码则更普通，基本没有用到什么 go 独有的特性。这也是 go 这门语言的特点，语法比较平淡。"},void 0,!1,void 0,this),`
`,n("h3",{children:"我认识的函数式编程"},void 0,!1,void 0,this),`
`,n("p",{children:"js 是一种多范式的编程语言，有 oo，有函数式风格，也有命令式风格。我所理解的函数式风格：面向表达式、编写纯函数，关注副作用。主流的编程语言或多或少都可以实现面向表达式编程，编写纯函数更像是一种代码实践。而关注副作用这点，很多语言就不好实现。"},void 0,!1,void 0,this),`
`,n("p",{children:"比如 js 中，object 是一种复杂类型，js 引擎本身并不保证一个 object 对象的内部的不可变性。对象内部的可变性，在多线程背景下，会引数据竞争问题，所以需要用户额外的处理。通常使用锁。js 是单线程执行引擎，在 js 中并没有特别强烈的对于锁的处理需求。但在 java、c++ 这类语言中，只能依赖用户自己实现多线程背景下的数据安全。可是多线程编程也是会引入一系列难题。这些都是难点。"},void 0,!1,void 0,this),`
`,n("p",{children:"rust 则是通过生命周期、借用、引用、移动来解决多线程并发难题。rust 的做法相当于将原来通过 gc 自动解决的问题，改为强约定式的人工处理。"},void 0,!1,void 0,this),`
`,n("h2",{children:"小结"},void 0,!1,void 0,this),`
`,n("p",{children:["rust 应该比 c++ 要简单一些的。语法有点不太适应，生态也慢慢做起来了。性能、静态编译支持也是卖点。rust 有目前最好的 wasm 工具链，后续我也会花更多时间学习 rust。至于为什么？",n("strong",{children:"always bet on js and wasm"},void 0,!1,void 0,this),"。"]},void 0,!0,void 0,this),`
`,n("h2",{children:"续"},void 0,!1,void 0,this),`
`,n("p",{children:["趁着双休，将原来用 go 实现的 ",n("a",{href:"https://github.com/yuekcc/init-nodejs-project-go",children:"init-nodejs-project-go"},void 0,!1,void 0,this)," 工具用 rust 重新写了一次。init-nodejs-project 是一个自用的 node.js 项目初始化工具，主要功能就是在一个空白目录里创建 package.json、.editorconfig、.gitignore、LICENSE 四个文件。"]},void 0,!0,void 0,this),`
`,n("p",{children:["通过 rust 内置的 ",n("code",{children:"include_str!()"},void 0,!1,void 0,this)," marco，可以直接很简单地内嵌一些文件或文本数据。这点估计也是 CTEE 特性带来的好处。项目本身不复杂，但用到了不少三方库。比如处理日期的 ",n("s",{children:"chrono"},void 0,!1,void 0,this)," time-rs、模板处理 handlebars 和 serde_json，命令行参数处理 ",n("s",{children:"gflags"},void 0,!1,void 0,this)," clap。但是在 golang 的实现中，这些功能都可以在 golang 的标准库找到相应的实现。在标准库这个问题上，rust 是小核心库 + 小标准库 + 第三方库的风格。golang 则是大标准库风格，尽可能提供常用的功能，开箱即用。"]},void 0,!0,void 0,this),`
`,n("p",{children:"golang 特别强调编译速度，甚至为了编译速度牺牲部分性能。以至 golang 的性能是编译型语言中最为一般的。配合强制的风格和比较简单的语法，所以 golang 特别适合中间件、命令行工具这些场景。带有 gc，也可以代替部分 java 的使用场景。"},void 0,!1,void 0,this),`
`,n("p",{children:"rust 有 c++++ 的嫌疑。性能比肩 c，声称安全第一；同时编译速度也比肩 c++，真的慢（和 golang 比）；rust 另一个著名的地方是上手难。不过我相信，c++ 更难。rust 的工具链也是相当现代化，模块管理、核心库这些都比 c++ 更现代化。"},void 0,!1,void 0,this),`
`,n("p",{children:["rust 版本的 init-nodejs-project 可以看这里：",n("a",{href:"https://github.com/yuekcc/init-nodejs-project",children:"yuekcc/init-nodejs-project"},void 0,!1,void 0,this),"。rust 版本的体积是真的小，优化下来不到 500k，go 版本怎么也得 1.5mb 左右。"]},void 0,!0,void 0,this),`
`,n("hr",{},void 0,!1,void 0,this),`
`,n("ul",{children:[`
`,n("li",{children:"2021 年 12 月 20 日，第一版"},void 0,!1,void 0,this),`
`,n("li",{children:"2022 年 01 月 10 日，更新“续”"},void 0,!1,void 0,this),`
`,n("li",{children:"2022 年 02 月 13 日，更新部分笔误"},void 0,!1,void 0,this),`
`,n("li",{children:"2022 年 04 月 25 日，部分文字更新，更新 picar-rs 代码量表格"},void 0,!1,void 0,this),`
`]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)}export{s as default};

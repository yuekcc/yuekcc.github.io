# nvim 笔记

nvim 是指 neovim。neovim 是在 vim 的基础上 fork 出来的一个版本。neovim 比有 vim 有更快的演进速度，也自带很多新功能。比如 LSP 支持等。nvim 的很多基础功能和 vim 保持一致。

## nvim 的模式

nvim 是一种基于模式的编辑器。nvim 有四个常用的模式：

| 模式         | 功能                                                                                                                                                      |
| ------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| normal mode  | 正常模式。一般用于游览文件，也可以进行复制、粘贴、删除等操作                                                                                              |
| insert mode  | 编辑模式。在 normal mode 可以通过 i、a、s、o 等快捷键进入到 insert mode。在 insert mode 可以通过按 ESC 键回到 normal mode                                 |
| command mode | 命令模式。在 normal mode 中按下 `:` 进入 command mode。command mode 用于执行 nvim 的功能，比如保存 `:w`，退出 `:q`                                        |
| visual mode  | 可视化模式。在 normal mode 按 `v` 可以进入可视化模式，visual mode 主要用于选择文本。启用了鼠标支持，在 normal mode 用鼠标选择文本也会自动进入 visual mode |

## 编辑文件

### 移动光标

最简单打开文件的方式是 `nvim file.txt`。nvim 打开文件后，默认会处于 normal mode。

在 normal mode 可以通过 `h j k l` 移动光标。h j k l 分别对应向左移动、向下移动、向上移动、 向右移动。 另外也有其他的光标移动快捷方式：

| 快捷键   | 功能                                                       |
| -------- | ---------------------------------------------------------- |
| `h`      | 向左移动                                                   |
| `j`      | 向下移动                                                   |
| `k`      | 向上移动                                                   |
| `l`      | 向右移动                                                   |
| `0`      | 移动到行首                                                 |
| `^`      | 移动到所在行第一个不是空白的字符                           |
| `$`      | 移动到行尾                                                 |
| `g_`     | 移动到所在行最一个不是空白的字符                           |
| `w`      | 移动到下一个单词的开头                                     |
| `e`      | 移动到下一个单词的结尾                                     |
| `fa`     | 移动到所在行下一个字符是 `a` 处                            |
| `nfa`    | 移动到所在行第 n 个字符是 `a` 处，`n` 是 1、2、3、... 数字 |
| `ta`     | 移动所在行下一个字符是 `a` 的前一个字符处                  |
| `nta`    | 移动到所在行是 `a` 的第 n 个字符处的前一个位置             |
| `nG`     | 光标定位到第 n 行的行首                                    |
| `gg`     | 光标定位到第一行的行首                                     |
| `G`      | 光标定位到最后一行的行首                                   |
| `H`      | 光标定位到当前屏幕的第一行行首                             |
| `M`      | 光标移动到当前屏幕的中间                                   |
| `L`      | 光标移动到当前屏幕的结尾                                   |
| `%`      | 匹配括号移动，括号是指 `(`、`{`、`[`，需要先移动到括号上   |
| ctrl + f | 查看下一页的内容                                           |
| ctrl + b | 查看上一页的内容                                           |

### 查找、替换

在 normal mode 按 `/{目标字符串}` 按 Enter 查找文本。按 `n` 跳转到下一个结果，按 `N` 跳转到上一个结果。 

在 command mode 按 `s/{目标字符串}/{新字符串}/g` 会将当前行的 `{目标字符串}` 替换为 `{新字符串}`。将 `s` 替换为 `%s` 可以进行全文替换。

`g` 是替换标记，`g` 表示 global，全局替换。还有 `i` 忽略大小写；`c` 表示需要确认。如果不查找 `g` 标记，只会进行一次替换。

### 删除、复制、粘贴

需要在 normal mode 执行。删除 `d`、复制 `y`、粘贴 `p`、删除单个字符 `x`。

删除的组合快捷键：

| 快捷键 | 功能                                       |
| ------ | ------------------------------------------ |
| `dw`   | 删除一个单词                               |
| `dnw`  | 删除 n 个单词                              |
| `dfa`  | 删除光标处到下一个字符 `a` 的文本          |
| `dnfa` | 删除光标处到第 n 个字符是 `a` 的文本       |
| `dd`   | 删除一行                                   |
| `ndd`  | 删除一整行                                 |
| `d$`   | 删除光标处开始到所在行的结尾处之间的文本   |
| `dH`   | 删除屏幕显示的第一行文本到光标处之间的文本 |
| `dG`   | 删除光标到所在行结尾的文本                 |

### 撤销操作

`u` 撤销刚才的操作。

ctrl + r 恢复撤销的操作。

### 替换单个字符

`r` 替换光标所在字符。

`R` 替换从光标开始后的所有字符，除非按 ESC 退出。

### 大小写转换

`~` 将光标处的字母改变大小写。


### 插入文本

在 normal mode 通过 `i I a A o O s S` 可以快速进入 insert 模式：

| 快捷键 | 功能                                                       |
| ------ | ---------------------------------------------------------- |
| `i`    | 在光标所在字符之前开始编辑                                 |
| `I`    | 在光标所在的行的行首开始编辑                               |
| `a`    | 在光标所在字符后开始编辑                                   |
| `o`    | 在光标所在行的插入空行，并在该行的行首开始编辑             |
| `O`    | 在光标所在行的向上增加一行空行，并在该行的行首开始编辑     |
| `s`    | 删除光标所在字符并插入编辑光标                             |
| `S`    | 清空光标所在的行，并在行首开始编辑                         |
| `cw`   | 删除光标所在字符处开始到该单词结束的所有字符，然后开始编辑 |

### 保存、退出

编辑文件需要先回到 normal mode 再通过 `:` 快捷键进入 command mode。在 command mode 通过 `w` 命令保存文件。nvim 也支持其他命令：

| 命令  | 功能                                                   |
| ----- | ------------------------------------------------------ |
| `w`   | 保存                                                   |
| `q`   | 退出编辑器。如果打开了多个 buffer，则关闭当前的 buffer |
| `wq`  | 保存并退出                                             |
| `q!`  | 不保存直接退出                                         |
| `set` | 设置 nvim。比如 `set nu` 显示行号                      |


----

- 2023-10-24